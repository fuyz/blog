<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <!-- 引入样式 -->
    <% include ./include/header-res.ejs %>
    <!--<link rel="stylesheet" href="/css/index.css">-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.8.5/css/froala_editor.pkgd.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.8.5/css/froala_style.min.css" rel="stylesheet"
          type="text/css"/>
    <style>

        .main {
            background: white;
            min-height: auto;
        }

        .sidebar {
            height: 100%;
            border-right: 1px solid #e9e9e9;
        }

        .sidebar i {
            color: #333;
            margin-right: 5px;
        }

        .toolItem {
            cursor: pointer;
            transition: all 0.3s;
        }

        .toolItem a {
            width: 100%;
            padding: 10px 20px;
            display: inline-block;
            color: #333;
        }

        .toolItem:hover {
            background: #2b669a;
            color: white;
        }

        .toolItem:hover a {
            color: white;
        }

        .toolItem:hover i {
            color: white;
        }

        .main-search-box {
            margin-top: 16px;
            padding: 16px;
            font-size: 14px;
            background: #f2f5f7;
        }

        .listWrap {
            width: 100%;
        }

        .item {
            /*height: 100px;/*/
            padding: 20px 0px;
            margin-bottom: 10px;
            border-bottom: 1px dotted #aaa;
        }

        .item-title {
            font-size: 18px;
        }

        .item-info {
            color: #aaa;
            font-size: 12px;
        }

        .item-info-oper a {
            padding-right: 8px;
            border-right: 1px solid #ccc;
            margin-right: 8px;
            color: #349EDF;
        }

        .item-info span {
            margin-right: 25px;
        }

        .item-info .del {
            color: #CA0C16;
            border-right: 0;
        }

    </style>

</head>
<body>
<% include ./include/header.ejs %>

<section class="main container">
    <div class="row">

        <ul class="sidebar col-6 col-md-2">
            <li class="toolItem">
                <a href="/blog"><i class="fa fa-pencil text-primary" aria-hidden="true"></i>写博客</a>
            </li>
            <li class="toolItem">
                <a href=""><i class="fa fa-file-text-o text-primary" aria-hidden="true"></i>文章管理</a>
            </li>
            <li class="toolItem">
                <a href="">专栏管理</a>
            </li>
            <li class="toolItem">
                <a href="">评论管理</a>
            </li>
            <li class="toolItem">
                <a href="">个人分类管理</a>
            </li>
            <li class="toolItem"><a href="">设置</a></li>
            <li class="toolItem"><a href="">博客设置</a></li>
            <li class="toolItem"><a href="">栏目管理</a></li>
            <li class="toolItem"><a href="">博客搬家</a></li>


        </ul>

        <div class="blogListWrap col-6 col-md-10">
            <div class="main-crumbs">文章管理</div>
            <div class="main-nav-tabs">
                <ul class="nav nav-pills" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" href="https://mp.csdn.net/postlist" role="tab"
                           aria-controls="pills-home" aria-selected="true">全部(40)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="https://mp.csdn.net/postlist/list/enable" role="tab"
                           aria-controls="pills-profile" aria-selected="false">已发表(40)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="https://mp.csdn.net/postlist/list/draft" role="tab"
                           aria-controls="pills-contact" aria-selected="false">草稿箱(0)</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="https://mp.csdn.net/postlist/list/deleted" role="tab"
                           aria-controls="pills-contact" aria-selected="false">
                            回收站(0)
                        </a>
                    </li>
                </ul>
            </div>
            <div class="main-search-box">
                <form class="mt-2 mt-md-0 main-nav-tab-search search_input"
                      action="https://mp.csdn.net/postlist/list/all">
                    <div class="dropdown year float-left mr8 default-val">
                        <label>发布时间：</label>
                        <select class="" aria-labelledby="droYear">
                            <option class="dropdown-item yearOption" data-val="">不限</option>
                            <option class="dropdown-item yearOption" data-val="2018">2018</option>
                            <option class="dropdown-item yearOption" data-val="2017">2017</option>
                        </select>
                    </div>
                    <div class="dropdown type float-left default-val mr24">
                        <label>文章类型：</label>
                        <select class="" aria-labelledby="droType">
                            <option class="dropdown-item" data-val="">不限类型</option>
                            <option class="dropdown-item" data-val="1">原创</option>
                            <option class="dropdown-item" data-val="2">转载</option>
                            <option class="dropdown-item" data-val="4">翻译</option>
                        </select>
                    </div>
                    <input class="txt-keyword mr24" id="key" type="text" name="keyword" value=""
                           placeholder="仅支持标题关键词搜索" aria-label="Search">
                    <button type="button" class="btn btn-danger btn-search float-right">搜索</button>
                </form>
            </div>
            <ul class="listWrap">
                <!--template-->
            </ul>

        </div>
        <ul class="pagination" id="paginationTemplate">
            <!--template-->
        </ul>
    </div>

</section>

<% include ./include/footer-res.ejs %>

<script id="blog_template" type="text/html">
    {{ if list.length > 0 }}
    {{each list }}
    <li class="item">
        <p class="item-title">{{ $value.title }}</p>
        <div class="item-info clear">
            <div class="left">
                <span>{{ $value.type | typeFormat }}</span>
                <span>{{ $value.createTime | dateFormat }}</span>
                <span>阅读量</span>
                <span>评论数</span>
            </div>
            <div class="right item-info-oper">
                <a href="">查看</a>
                <a href="">禁止评论</a>
                <a href="">置顶 </a>
                <a class="del" href="">删除</a>
            </div>
        </div>
    </li>
    {{ /each }}
    {{ else }}
    <p>暂无用户信息</p>
    {{ /if }}
</script>
<script id="pagination_template" type="text/html">
    <li class="prePage">
        <a href="#" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
        </a>
    </li>
    {{each list2 }}
    <li class="pageItem {{$value}}"><a href="#">{{ $index + 1 }}</a></li>
    {{ /each }}
    <li class="nextPage">
        <a href="#" aria-label="Next">
            <span aria-hidden="true">&raquo;</span>
        </a>
    </li>
</script>

<!-- Include Editor JS files. -->
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.8.5/js/froala_editor.pkgd.min.js"></script>

<script>

    $(document).ready(function () {

        class Manage {
            constructor() {
                this.data = {
                    userInfo: null,
                    showAside: false,

                }
            }

            initial() {

                manage.userInfo = JSON.parse(sessionStorage.getItem('user'));

                manage.getBlogList({});
            }

            getBlogList(obj) {
                ajaxData('post', '/getBlogs', {
                    pagesize: 10,
                    currentPage: obj.currentPage,

                }).then(function (res) {
                    if (res.success) {
                        let data = {
                            list: res.data.pageData
                        };
                        let str = template('blog_template', data);
                        $('.listWrap').html(str);

                    }
                });

            }
        }


        let manage = new Manage();
        manage.initial();
        template.defaults.imports.dateFormat = function(val){
            return new Date(Number(val)).toLocaleString();
        };
        template.defaults.imports.typeFormat = function(val) {
            switch (val){
                case '1':
                    return '原创';
                    break;
                case '2':
                    return '转载';
                    break;
                case '3':
                    return '翻译';
                    break;
                default:
                    return '不知道类型';
            }
        }


        });


</script>
</body>
</html>
